\chapter*{Введение}
\addcontentsline{toc}{chapter}{Введение}
Визуальное моделирование --- это подход, при использовании которого программа представляется в 
виде набора графических моделей, каждая из которых описывает её с разных точек 
зрения. Благодаря наличию стандартных широко распространённых графических языков, 
визуальное моделирование повышает продуктивность труда и качество результирующего 
продукта при разработке. Существуют исследования, подтверждающие это экспериментально, см., 
например,~\cite{heijstek2009empirical, baker2005model}.

Сейчас визуальные модели используются в основном при анализе и проектировании, 
а также как средство документирования и передачи информации между 
разработчиками. Однако же программы целиком или их фрагменты возможно 
автоматически генерировать по набору визуальных моделей. Это позволяет 
непосредственно использовать результаты анализа и проектирования и в 
значительной степени автоматизировать труд программистов, давая им возможность 
работать не с кодом программы на текстовом языке, а с гораздо более наглядными 
визуальными моделями. 

Использование визуальных языков общего назначения, таких как \ac{UML}, без заранее 
подготовленного набора библиотек и генераторов, делает задачу разработки 
программного обеспечения только с помощью графических языков сложной, 
в силу наличия семантического разрыва между кодом и моделями 
\cite{selic2003pragmatics, koznov2008osnovy}. Такие языки работают в 
тех же терминах, в которых пишется исходный код на традиционных текстовых языках 
(классы, объекты, компоненты и т.д.), поэтому чтобы полностью специфицировать 
поведение системы и сделать возможной автоматическую генерацию, модель должна 
содержать в себе столько же информации, что и исходный код программы, что 
противоречит самому понятию модели как некоего упрощения моделируемого объекта. 
На самом деле, визуальная модель в этом случае даже менее удобна, чем код 
программы --- визуальные символы занимают на экране больше места, чем текст. 
Если же визуальная модель будет изображать только важные аспекты 
функционирования системы, опуская излишние подробности, то её можно будет 
сохранить обозримой и полезной для человека, но это сделает её бесполезной для 
исполнителя (например, для интерпретатора, или генератора исходного кода). 
Именно так, в основном, используется \ac{UML} сейчас --- как средство для анализа и 
дизайна системы, а сама система специфицируется ручным кодированием на текстовых 
языках. Большинство инструментов для рисования UML-диаграмм позволяют 
сгенерировать заглушки, куда предполагается дописывать код вручную, но 
существенного выигрыша для разработчиков это не даёт. Подтверждение этим фактам 
можно найти в относительно недавних исследованиях 
\cite{mohagheghi2013empirical, chen2012methodology}. Наличие заранее подготовленных 
библиотек, шаблонов и генераторов кода может существенно улучшить ситуацию, как показано,
например, в~\cite{baker2005model} и в~\cite{swithinbank2005patterns}, но подобные 
технологии оказываются применимы только для той предметной области, для которой они создавались.

Существует принципиально другой подход к использованию визуального 
моделирования, называемый предметно-ориентированным моделированием 
(\ac{DSM},~\cite{kelly2008domain}). Он основан на том 
наблюдении, что иногда создать новый язык для какой-то узкой предметной области 
или даже для конкретной задачи и решить задачу на нём оказывается быстрее и 
эффективнее, чем решать эту задачу на языке общего назначения. В таком случае 
наличие у средств поддержки создаваемого языка знаний о предметной области 
позволяет добиться полной автоматической генерации программ про визуальным 
моделям. 

Существует много широко известных текстовых предметно-ориентированных языков, 
например, язык для работы с данными \ac{SQL}, 
язык для работы с текстами awk\footnote{Спецификация AWK, URL: http://pubs.opengroup.org/onlinepubs/9699919799/utilities/awk.html 
(дата обращения 22.02.2014г.)}, средства описания контекстно-свободных грамматик для генераторов синтаксических 
анализаторов. В каждом из этих примеров программа на предметно-ориентированном 
языке работает в терминах той предметной области, для которой этот язык создан,
что даёт возможность не задумываясь о деталях реализации решать требуемую 
задачу. Например, современные генераторы синтаксических анализаторов позволяют 
задавать грамматику в виде, очень похожем на формы Бэкуса-Наура, при этом 
программист может не думать о том, как будет реализован синтаксический 
анализатор для этой грамматики: каким-либо из автоматных методов или рекурсивным 
спуском. Как правило, допускаются и некоторые неоднозначности грамматики, и 
грамматики, плохие с точки зрения метода разбора, который реализует 
синтаксический анализатор (например, леворекурсивные грамматики для метода 
рекурсивного спуска). Всё это позволяет реализовывать синтаксические анализаторы 
даже людям, весьма поверхностно представляющим себе алгоритмы синтаксического 
анализа. Это общее свойство предметно-ориентированных языков --- знания о 
предметной области <<спрятаны>> в инструментальные средства, что позволяет 
существенно расширить круг пользователей языка, вплоть до того, что на нём 
смогут программировать люди, далёкие от программирования. Исследования 
\cite{kieburtz1996software, kelly2000visual, gray2003examination} показывают, 
что продуктивность труда программистов при использовании 
предметно-ориентированных языков вырастает в 3-10 раз по сравнению с 
использованием языков общего назначения, поэтому такой подход представляется 
весьма перспективным.

Разумеется, создавать новый предметно-ориентированный визуальный язык и 
инструментальные средства его поддержки <<с нуля>> для каждой узкой предметной 
области или конкретной задачи было бы неоправданно трудозатратно. Поэтому 
существуют специальные средства для автоматизации этой задачи, называемые 
<<\acsu{dsmPlatform}>>, или <<\acsu{metaCaseTool}>>. Такие средства позволяют задать 
синтаксис визуального языка, используя какой-либо формализм (как правило, 
это метамодели), и автоматически сгенерировать редактор этого языка и другие средства инструментальной 
поддержки\footnote{Далее мы будем именовать визуальный редактор и инструментальные 
средства для работы с предметно-ориентированным языком <<\acsu{dsmSolution}>>)}. 
Это позволяет реализовывать технологии программирования, использующие новые предметно-ориентированные языки, за время 
порядка дней, что делает предметно-ориентированное моделирование оправданным 
даже для небольших проектов. Существуют зрелые исследовательские и промышленные 
\ac{DSM}-платформы, такие как Eclipse Modeling 
Project\footnote{Домашняя страница Eclipse Modeling Project, URL: http://www.eclipse.org/modeling/},
MetaEdit+\footnote{Домашняя страница MetaEdit+, URL: http://www.metacase.com/products.html} 
и другие. Однако же, несмотря на значительные преимущества предметно-ориентированного 
моделирования, применяется оно довольно редко. Связано это, в частности, с 
недостатками существующих платформ и отсутствием развитой методологической 
базы для их применения. 
% TODO: Подтверждение
Во многих случаях для создания предметно-ориентированного 
решения требуется привлекать экспертов в создании языков, которыми зачастую 
оказываются авторы выбранной для реализации этого решения \ac{DSM}-платформы, поэтому 
позволить себе это могут лишь крупные компании. Такая ситуация указывает на 
необходимость продолжения исследований в этой области, что и стало предметом 
данной работы.

\textbf{Целью} диссертационной работы является исследование предметно-ориентированных 
визуальных языков, их свойств и процесса их разработки, создание методологии и технологии
разработки предметно-ориентированных решений, достаточно простой в применении, 
чтобы предметно-ориентированный язык и инструментальные средства для него (редактор диаграмм, 
генератор кода, средства проверки ограничений на диаграммы, интерпретатор диаграмм)
было возможно создать за время порядка часов даже без специальной подготовки и опыта.

Для достижения поставленной цели необходимо было решить следующие \textbf{задачи}:
\begin{enumerate}
	\item провести обзор подходов к реализации визуальных языков и средств, их реализующих;
	\item разработать в рамках \ac{DSM}-платформы QReal~\cite{terekhov2009architecture, kuzenkova2011qreal}
		простую в использовании технологию создания предметно-ориентированных языков;
	\item реализовать разработанную технологию в виде промышленного продукта;
	\item провести апробацию технологии путём создания нескольких \ac{DSM}-решений с её помощью.
% TODO: Провести эксперимент, доказывающий достижение заявленной цели работы.
\end{enumerate}

\textbf{Объектом исследования} являются визуальные языки, методы их создания и технологии
для разработки инструментальных средств визуальных языков.

В качестве \textbf{методов исследования} используются: теория формальных языков, теория графов, 
методы объектно-ориентированного программирования.

\textbf{Научная новизна} данной работы заключается в следующем:
\begin{enumerate}
	\item Разработана новая методика и набор инструментальных средств для создания предметно-ориентированных 
		языков с помощью графического языка метамоделирования и сопутствующих визуальных языков.
		Методика предполагает применение предметно-ориентированного подхода <<самого к себе>>, то есть
		предметно-ориентированные языки используются для описания всей функциональности разрабатываемых
		инструментальных средств для нового языка: редактора диаграмм, генераторов кода на текстовых языках по 
		диаграммам, интерпретаторов, средств проверки ограничений на диаграммы, средств поддержки рефакторингов.
	\item Предложен новый способ создания предметно-ориентированного языка: <<метамоделирование на лету>>. 
		Способ предполагает изменение и дополнение визуального языка прямо в процессе создания диаграммы на нём,
		без использования отдельного метаредактора. В процессе разработки языка при таком подходе
		не требуется оперировать с понятиями <<метамодель>> и <<метаредактор>>, что снижает 
		требования к квалификации пользователей.
	\item С использованием предложенных методик разработаны новые предметно-ориентированные языки и
		средства инструментальной поддержки для них: язык программирования роботов и среда QReal:Robots
		(также известная как TRIK Studio, см. приложение~\ref{chapter:qRealRobots}), 
		средство программирования приложений для мобильных телефонов QReal:Ubiq (см. приложение~\ref{chapter:qRealUbiq}), 
		средство разработки аппаратных систем QReal:HaSCoL (см. приложение~\ref{chapter:qRealHascol}).
\end{enumerate}

\textbf{Практическая ценность} данной работы определяется использованием полученных 
результатов при разработке \ac{DSM}-платформы QReal~\cite{terekhov2009architecture, kuzenkova2011qreal}, 
в ряде \ac{DSM}-решений, созданных с её помощью, самым зрелым из которых стала среда программирования 
роботов QReal:Robots (TRIK Studio)~\cite{bryksin2011robots}, предназначенная для обучения 
школьников основам информатики и кибернетики с использованием робототехнических 
конструкторов ТРИК\footnote{Домашняя страница робототехнического конструктора ТРИК, URL: http://trikset.com (дата обращения: 15.02.2015г)}%
, Lego Mindstorms NXT, Lego Mindstorms EV3%
\footnote{Домашняя страница робототехнических конструкторов Lego Mindstorms NXT, Lego Mindstorms EV3,
URL: http://www.lego.com/en-us/mindstorms (дата обращения: 22.02.2014г)}.

Среда QReal разрабатывается в рамках деятельности научно-исследовательской 
группы по изучению визуального моделирования под руководством проф. 
А.Н.~Терехова с 2007 года и базируется на более чем двадцатилетнем опыте 
коллектива кафедры системного программирования Санкт-Петербургского 
государственного университета в разработке графических языков 
\cite{ivanov2005realit, parfenov1997rtst, terekhov1998rtst, ivanov1998object, ivanov1998behavioral}. 
Проект имеет открытый исходный 
код\footnote{Страница проекта и репозиторий с исходным кодом на GitHub, URL: https://github.com/qreal/qreal}, 
разрабатывается на языке C++ с использованием библиотеки Qt силами студентов и преподавателей кафедры, автор 
данной диссертации --- один из руководителей проекта. QReal создаётся как 
средство визуального моделирования, поддерживающее ряд широкоизвестных 
визуальных языков (\ac{UML} 2.0, \ac{BPMN}, блок-схемы), и одновременно как \ac{dsmPlatform}, 
позволяющая быстро и без специальных знаний создавать свои собственные 
визуальные языки и \ac{DSM}-решения на их основе. На данный момент среда существует 
в виде работающего прототипа. Проект поддержан грантом Санкт-Петербургского 
государственного университета 6.39.1054.2012. \ac{dsmPlatform} QReal использовалась
для реализации ряда предметно-ориентированных решений, использовавшихся в 
проектах компании <<ЛАНИТ-Терком>>, связанных с разработкой информационных систем 
и систем компьютерного зрения.

Среда программирования роботов QReal:Robots (или TRIK Studio) --- на данный момент наиболее зрелая 
предметно-ориентированная технология из созданных с помощью среды QReal. 
Условия, в которых она появилась, близки к идеальным для применения 
предметно-ориентированного подхода: достаточно узкая предметная область, 
необходимость в средствах для создания нетривиальных программ, при этом
программы хорошо выражаются в терминах визуального языка. Задача заключается в 
следующем: в школах со времён академика Ершова для преподавания информатики 
используется понятие <<исполнитель>> --- некоторый объект, исполняющий команды, 
описанные в программе. В роли такого исполнителя до сих пор применяется 
<<черепашка>> LOGO\footnote{См., например, MyRobot, Язык программирования Лого, URL: http://myrobot.ru/logo/aboutlogo.php}, 
но она постепенно вытесняется реальными исполнителями --- роботами, собираемыми из робототехнических конструкторов, 
самый популярный из которых на данный момент --- Lego Mindstorms NXT. 
Программировать такие роботы труднее, чем <<черепашку>>, поскольку из набора 
можно собрать какую угодно конструкцию, и программировать приходится в терминах 
мощности и оборотов моторов, а не в командах вида <<вперёд на 20 шагов>>, 
<<влево на 90 градусов>>, как в <<черепашке>>. Поэтому (и с учётом того, что 
обучение информатике на этих конструкторах начинается с пятого класса) требуется 
представлять программу возможно более наглядно, и графические языки подходят 
для этой цели гораздо лучше, чем текстовые. 

Первый прототип среды программирования был разработан автором данной диссертации
с использованием системы QReal примерно за неделю, и включал в себя визуальный 
язык из примерно 20 сущностей, редактор к нему и интерпретатор, позволяющий 
исполнить программу на компьютере, посылая команды роботу по интерфейсу 
\ac{Bluetooth}. На данный момент система развилась в полноценный программный продукт, 
используемый во многих кружках по робототехнике в России и ближнем зарубежье.

\textbf{Апробация работы} заключается в следующем.
\begin{itemize}
	\item Некоторые результаты данной работы были доложены на второй 
		научно-технической конференции молодых специалистов <<Старт в будущее>> 
		(Санкт-Петербург, 2011) \cite{kuzenkova2011metamodeling}. Доклад был 
		отмечен наградой.
	\item Результаты, связанные с применением разработанной технологии при 
		создании среды QReal:Robots были доложены на VII Международной 
		научно-практической конференции <<Современные информационные технологии 
		и ИТ-образование>> (Москва, 2012) \cite{litvinov2012robots}.
	\item Результаты, связанные с применением разработанной технологии для 
		разработки предметно-ориентированного языка для платформы Ubiq были доложены 
		на международной конференции <<10th Conference of Open Innovations 
		Association FRUCT>> (Tampere, 2011) \cite{bryksin2011ubiq}.
	\item Результаты диссертации использовались  при проектировании и реализации 
		\ac{DSM}-платформы QReal и ряда \ac{DSM}-решений, созданных с её помощью, включая 
		среду программирования роботов QReal:Robots. Среда QReal использовалась для 
		создания нескольких предметно-ориентированных решений в ЗАО <<ЛАНИТ-Терком>>. 
		Среда QReal:Robots демонстрировалась на Открытых состязаниях 
		Санкт-Петербурга по робототехнике в 2012 году и на робототехническом 
		фестивале <<Робофест 2012>> в Москве. Также она применялась для обучения 
		школьников робототехнике в летнем робототехническом лагере в 
		г. Сиверском в 2012 году. На данный момент эта среда переименована в 
		TRIK Studio и используется как основное средство программирования 
		кибертенического конструктора 
		ТРИК\footnote{Домашняя страница конструктора, URL: http://trikset.com/ (дата обращения: 20.08.2014)},
		используется в нескольких робототехнических кружках в России и на мастер-классах
		по робототехнике, проводимых компанией <<Кибернетические технологии>>.
	\item По теме диссертации опубликовано пять научных работ (три из них ---
		в сборнике из списка ВАК, две другие --- в сборнике, входящем в РИНЦ) и 
		десять тезисов докладов на конференциях (под авторством или в соавторстве с 
		автором диссертации), включая один, индексированный в библиографических базах данных
		Web Of Science и Scopus.
\end{itemize}

\textbf{Основные результаты} данной работы таковы.
\begin{enumerate}
	\item Проведён анализ различных подходов к созданию инструментов для работы с визуальными языками и 
		различных технологических средств, их реализующих. Выявлено отсутствие в существующих
		системах инструментальной поддержки самых ранних этапов разработки языка и недостаточная
		автоматизация последующих этапов.
	\item Разработана методика и набор инструментальных средств для разработки 
		предметно-ориентированных языков с помощью графического языка 
		метамоделирования и сопутствующих визуальных языков.
	\item Предложена новая методика метамоделирования, предполагающая расширение 
		и уточнение предметно-ориентированного языка прямо в процессе его 
		использования (<<метамоделирование на лету>>). 
	\item Предложенные методики и технологии реализованы в виде промышленного 
		продукта QReal.
	\item Проведена апробация разработанных средств при создании системы
		QReal:Robots и нескольких других предметно-ориентированных решений.
\end{enumerate}

Ниже приведён краткий план последующих глав диссертации.

В \textbf{Главе 1} приводятся основные понятия, используемые в 
предметно-ориентированном визуальном моделировании, обсуждается структура 
визуального языка, уровни абстракции, вводятся некоторые свойства визуальных 
языков, важные для дальнейшего изложения.

\textbf{Глава 2} содержит обзор существующих подходов к созданию \ac{DSM}-решений: 
обсуждаются возможности, достоинства и недостатки существующих \ac{DSM}-платформ, 
включая зрелые системы и академические разработки, анализируются существующие 
методологии создания, внедрения и сопровождения визуальных языков и \ac{DSM}-решений, 
делаются выводы, касающиеся текущего состояния исследований в этой области.

\textbf{Глава 3} содержит описание предлагаемого подхода к разработке 
\ac{DSM}-решений: приводятся этапы жизненного цикла \ac{DSM}-решения, обсуждается 
возможная степень автоматизации каждого этапа, формулируются требования на 
средства автоматизации, приводится описание предлагаемой технологии, включающей 
технику метамоделирования <<на лету>>.

В \textbf{Главе 4} анализируются результаты реализации инструментальных средств 
поддержки предлагаемой технологии в проекте QReal. Описываются возможности 
системы QReal, связанные с поддержкой техник метамоделирования, принятые 
архитектурные решения, приводятся соображения по дальнейшему развитию 
инструментальных средств.

\textbf{Приложение A} содержит примеры применения результатов, описанных в данной 
диссертации, для разработки \ac{DSM}-решений. Описывается среда QReal:Robots, то, 
какие преимущества были получены от использования \ac{DSM}-платформы QReal при её 
разработке, то, чем QReal помочь не смог, и почему. Также приводится 
описание среды разработки сервисов для мобильных телефонов QReal:Ubiq и среды
разработки аппаратуры QReal:HaSCoL, описываются их визуальные языки, 
достоинства и недостатки использованных при их создании подходов.

\textbf{Приложение B} содержит описание визуального метаязыка системы QReal.
