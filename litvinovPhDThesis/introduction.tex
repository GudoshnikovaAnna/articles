\chapter*{Введение}
\addcontentsline{toc}{chapter}{Введение}
\textbf{Актуальность темы.}
Визуальное моделирование --- это подход, при использовании которого программа представляется в 
виде набора графических моделей, каждая из которых описывает её с разных точек 
зрения. Благодаря наличию стандартных широко распространённых графических языков, 
визуальное моделирование повышает продуктивность труда и качество результирующего 
продукта при разработке. Существуют исследования, подтверждающие это экспериментально, см., 
например,~\cite{heijstek2009empirical, baker2005model}.

Сейчас визуальные модели используются в основном при анализе и проектировании, 
а также как средство документирования и передачи информации между 
разработчиками. Однако же программы целиком или их фрагменты возможно 
автоматически генерировать по набору визуальных моделей. Это позволяет 
непосредственно использовать результаты анализа и проектирования и в 
значительной степени автоматизировать труд программистов, давая им возможность 
работать не с кодом программы на текстовом языке, а с гораздо более наглядными 
визуальными моделями. 

Использование визуальных языков общего назначения, таких как \ac{UML}, без заранее 
подготовленного набора библиотек и генераторов, делает задачу разработки 
программного обеспечения только с помощью графических языков сложной, 
в силу наличия семантического разрыва между кодом и моделями 
\cite{selic2003pragmatics, koznov2008osnovy}. Такие языки работают в 
тех же терминах, в которых пишется исходный код на традиционных текстовых языках 
(классы, объекты, компоненты и т.д.), поэтому чтобы полностью специфицировать 
поведение системы и сделать возможной автоматическую генерацию, модель должна 
содержать в себе столько же информации, что и исходный код программы, что 
противоречит самому понятию модели как некоего упрощения моделируемого объекта. 
На самом деле, визуальная модель в этом случае даже менее удобна, чем код 
программы --- визуальные символы занимают на экране больше места, чем текст. 
Если же визуальная модель будет изображать только важные аспекты 
функционирования системы, опуская излишние подробности, то её можно будет 
сохранить обозримой и полезной для человека, но это сделает её бесполезной для 
исполнителя (например, для интерпретатора, или генератора исходного кода). 
Именно так, в основном, используется \ac{UML} сейчас --- как средство для анализа и 
дизайна системы, а сама система специфицируется ручным кодированием на текстовых 
языках. Большинство инструментов для рисования UML-диаграмм позволяют 
сгенерировать заглушки, куда предполагается дописывать код вручную, но 
существенного выигрыша для разработчиков это не даёт. Подтверждение этим фактам 
можно найти в относительно недавних исследованиях 
\cite{mohagheghi2013empirical, chen2012methodology}. Наличие заранее подготовленных 
библиотек, шаблонов и генераторов кода может существенно улучшить ситуацию, как показано,
например, в~\cite{baker2005model} и в~\cite{swithinbank2005patterns}, но подобные 
технологии оказываются применимы только для той предметной области, для которой они создавались.

Существует принципиально другой подход к использованию визуального 
моделирования, называемый предметно-ориентированным моделированием 
(\ac{DSM},~\cite{kelly2008domain}). Он основан на том 
наблюдении, что иногда создать новый язык для какой-то узкой предметной области 
или даже для конкретной задачи и решить задачу на нём оказывается быстрее и 
эффективнее, чем решать эту задачу на языке общего назначения. В таком случае 
наличие у средств поддержки создаваемого языка знаний о предметной области 
позволяет добиться полной автоматической генерации программ про визуальным 
моделям. 

Существует много широко известных текстовых предметно-ориентированных языков, 
например, язык для работы с данными \ac{SQL}, 
язык для работы с текстами awk~\cite{awk}, средства описания контекстно-свободных грамматик для генераторов синтаксических 
анализаторов. В каждом из этих примеров программа на предметно-ориентированном 
языке работает в терминах той предметной области, для которой этот язык создан,
что даёт возможность не задумываясь о деталях реализации решать требуемую 
задачу. Например, современные генераторы синтаксических анализаторов позволяют 
задавать грамматику в виде, очень похожем на формы Бэкуса-Наура, при этом 
программист может не думать о том, как будет реализован синтаксический 
анализатор для этой грамматики: каким-либо из автоматных методов или рекурсивным 
спуском. Как правило, допускаются и некоторые неоднозначности грамматики, и 
грамматики, плохие с точки зрения метода разбора, который реализует 
синтаксический анализатор (например, леворекурсивные грамматики для метода 
рекурсивного спуска). Всё это позволяет реализовывать синтаксические анализаторы 
даже людям, весьма поверхностно представляющим себе алгоритмы синтаксического 
анализа. Это общее свойство предметно-ориентированных языков --- знания о 
предметной области <<спрятаны>> в инструментальные средства, что позволяет 
существенно расширить круг пользователей языка, вплоть до того, что на нём 
смогут программировать люди, далёкие от программирования. Исследования 
\cite{kieburtz1996software, kelly2000visual, gray2003examination} показывают, 
что продуктивность труда программистов при использовании 
предметно-ориентированных языков вырастает в 3-10 раз по сравнению с 
использованием языков общего назначения, поэтому такой подход представляется 
весьма перспективным.

Разумеется, создавать новый предметно-ориентированный визуальный язык и 
инструментальные средства его поддержки <<с нуля>> для каждой узкой предметной 
области или конкретной задачи было бы неоправданно трудозатратно. Поэтому 
существуют специальные средства для автоматизации этой задачи, называемые 
<<\acsu{dsmPlatform}>>, или <<\acsu{metaCaseTool}>>. Такие средства позволяют задать 
синтаксис визуального языка, используя какой-либо формализм (как правило, 
это метамодели), и автоматически сгенерировать редактор этого языка и другие средства инструментальной 
поддержки\footnote{Далее мы будем именовать визуальный редактор и инструментальные 
средства для работы с предметно-ориентированным языком <<\acsu{dsmSolution}>>)}. 
Это позволяет реализовывать технологии программирования, использующие новые предметно-ориентированные языки, за время 
порядка дней, что делает предметно-ориентированное моделирование оправданным 
даже для небольших проектов. Существуют зрелые исследовательские и промышленные 
\ac{DSM}-платформы, такие как Eclipse Modeling Project~\cite{emp}, MetaEdit+~\cite{metaEdit} 
и другие. Однако же, несмотря на значительные преимущества предметно-ориентированного 
моделирования, применяется оно довольно редко. Связано это, в частности, с 
недостатками существующих платформ и отсутствием развитой методологической 
базы для их применения. Во многих случаях для создания предметно-ориентированного 
решения требуется привлекать экспертов в создании языков, которыми зачастую 
оказываются авторы выбранной для реализации этого решения \ac{DSM}-платформы, поэтому 
позволить себе это могут лишь крупные компании. Такая ситуация указывает на 
необходимость продолжения исследований в этой области с целью упростить процесс создания
предметно-ориентированных решений и снизить требования к квалификации специалистов, 
которые могли бы этим заниматься.

\textbf{Степень разработанности темы.}
Методические вопросы создания предметно-ориентированных языков хорошо проработаны в случае, если 
языки текстовые (заслуживают упоминания работы A. Van Deursen, M. Mernik), для визуальных
языков сейчас существует лишь набор слабо структурированных рекомендаций и наблюдений
(наиболее обстоятельно этим вопросом занималась исследовательская группа во главе 
со S. Kelly и J.-P. Tolvanen, заслуживают упоминания работы M. Voelter). Тем не менее, 
существует довольно много DSM-платформ, многие из которых хорошо описаны в литературе 
(MetaEdit+, Eclipse Modeling Project, Generic Modeling Environment, PSL/PSA, AToM\textsuperscript{3},
Microsoft Modeling SDK, Pounamu, DOME, MetaLanguage), анализ возможностей данных
платформ занимает значительную часть главы 2 данной работы. Подавляющее большинство 
научных работ, связанных с этими DSM-платформами, сфокусированы на технических подробностях
их реализации и обходят стороной вопросы методической поддержки, при этом часто внимание 
уделяется только самой визуализации визуального языка.

Данная работа выполнялась в рамках проекта по разработке DSM-платформы QReal, аналога
вышеперечисленных DSM-платформ, разрабатываемого на кафедре системного программирования
Санкт-Петербургского государственного университета. Эта среда разрабатывается в рамках 
деятельности научно-исследовательской группы по изучению визуального моделирования 
под руководством проф. А.Н.~Терехова с 2007 года и базируется на более чем двадцатилетнем 
опыте в разработке графических языков (технологии RTST, RTST++, REAL). Проект QReal имеет 
открытый исходный код~\cite{qrealGithub}, разрабатывается на языке C++ с использованием 
библиотеки Qt силами студентов и преподавателей кафедры, автор данной диссертации --- 
один из руководителей проекта.

\textbf{Целью} диссертационной работы является уменьшение трудозатрат и требований к квалификации
при создании визуальных предметно-ориентированных языков и инструментальных средств для них (редакторов диаграмм, 
генераторов кода, средств проверки ограничений на диаграммы, интерпретаторов диаграмм)
до уровня, при котором их было бы возможно создать за время порядка часов даже без 
специальной подготовки и опыта

Для достижения поставленной цели достаточно было решить следующие \textbf{задачи}.
\begin{enumerate}
	\item Разработать методику создания предметно-ориентированных языков и инструментальных 
		средств для них, использующую визуальные языки для их спецификации.
	\item Разработать способ прототипирования визуального языка, позволяющую специфицировать его
		прямо в процессе создания на нём диаграммы.
	\item Реализовать в рамках DSM-платформы QReal простую в использовании технологию 
		создания предметно-ориентированных языков, реализующую разработанные методики.
	\item Провести апробацию технологии путём создания нескольких DSM-решений с её помощью.
\end{enumerate}

Цель и задачи диссертационной работы соответствуют области исследований паспорта специальности 
05.13.11 <<Математическое и программное обеспечение вычислительных машин, комплексов и компьютерных сетей>>: 
пунктам 1 (Модели, методы и алгоритмы проектирования и анализа программ и программных 
систем, их эквивалентных преобразований, верификации и тестирования) и 2 (Языки программирования 
и системы программирования, семантика программ).

\textbf{Объектом исследования} являются визуальные языки, \textbf{предметом исследования} 
являются методы их создания и технологии для разработки инструментальных средств визуальных языков.

В качестве \textbf{методологии} используется методология, типичная для исследований в 
области программной инженерии: исследование существующей литературы, формулирование задачи 
и поиск её возможного решения, реализация решения в виде набора инструментов, апробация 
и анализ результатов. При этом в качестве \textbf{методов исследования} используются 
методы теории формальных языков, теории графов, методы объектно-ориентированного программирования, 
эмпирические методы (методы анализа литературы и постановки эксперимента).

\textbf{Научная новизна} данной работы заключается в следующем:
\begin{enumerate}
	\item Разработанная методика для создания предметно-ориентированных языков с помощью 
		графического языка метамоделирования и сопутствующих визуальных языков превосходит 
		известные аналоги по объёму функциональных возможностей инструментальных средств, 
		которые можно специфицировать с помощью визуальных языков. Методика 
		предполагает применение предметно-ориентированного подхода <<самого к себе>>, то есть
		предметно-ориентированные языки используются для описания всей функциональности 
		разрабатываемых инструментальных средств для нового языка: редактора диаграмм, 
		генераторов текстового кода по диаграммам, интерпретаторов, средств проверки ограничений 
		на диаграммы, средств поддержки рефакторингов.
	\item Предложенный способ создания предметно-ориентированного языка (<<метамоделирование на лету>>)
		является оригинальным. Способ предполагает изменение и дополнение визуального языка прямо в 
		процессе создания диаграммы на нём, без использования отдельного метаредактора. В процессе 
		разработки языка при таком подходе не требуется оперировать с понятиями <<метамодель>> и 
		<<метаредактор>>, что снижает требования к квалификации пользователей.
	\item Разработанные с использованием предложенных методик визуальный язык программирования роботов 
		и среда QReal:Robots, предоставляющая для него средства инструментальной поддержки, 
		превосходит известные аналоги по ряду параметров, описанных в приложении~\ref{chapter:qRealRobots}.
\end{enumerate}

\textbf{Теоретическая и практическая значимость} данной работы определяется разработанными 
методами создания визуальных предметно-ориентированных языков и использованием полученных 
результатов при разработке \ac{DSM}-платформы QReal~\cite{terekhov2009architecture, kuzenkova2011qreal}, 
в ряде \ac{DSM}-решений, созданных с её помощью, самым зрелым из которых стала среда программирования 
роботов QReal:Robots~\cite{bryksin2011robots}, предназначенная для обучения 
школьников основам информатики и кибернетики с использованием робототехнических 
конструкторов ТРИК~\cite{trik}, Lego Mindstorms NXT, Lego Mindstorms EV3~\cite{mindstorms}.

QReal создаётся как средство визуального моделирования, поддерживающее ряд широкоизвестных 
визуальных языков (\ac{UML} 2.0, \ac{BPMN}, блок-схемы), и одновременно как \ac{dsmPlatform}, 
позволяющая быстро и без специальных знаний создавать свои собственные 
визуальные языки и \ac{DSM}-решения на их основе. На данный момент среда существует 
в виде работающего прототипа. Проект поддержан грантом Санкт-Петербургского 
государственного университета 6.39.1054.2012. \ac{dsmPlatform} QReal использовалась
для реализации ряда предметно-ориентированных решений, использовавшихся в 
проектах компании <<ЛАНИТ-Терком>>, связанных с разработкой информационных систем 
и систем компьютерного зрения.

Среда программирования роботов QReal:Robots --- на данный момент наиболее зрелая 
предметно-ориентированная технология из созданных с помощью среды QReal. 
Условия, в которых она появилась, близки к идеальным для применения 
предметно-ориентированного подхода: достаточно узкая предметная область, 
необходимость в средствах для создания нетривиальных программ, при этом
программы хорошо выражаются в терминах визуального языка. Задача заключается в 
следующем: в школах со времён академика Ершова для преподавания информатики 
используется понятие <<исполнитель>> --- некоторый объект, исполняющий команды, 
описанные в программе. В роли такого исполнителя до сих пор применяется 
<<черепашка>> LOGO~\cite{myrobot}, но она постепенно вытесняется реальными исполнителями --- 
роботами, собираемыми из робототехнических конструкторов, самый популярный из которых на 
данный момент --- Lego Mindstorms NXT. Программировать такие роботы труднее, чем <<черепашку>>, 
поскольку из набора можно собрать какую угодно конструкцию, и программировать приходится в терминах 
мощности и оборотов моторов, а не в командах вида <<вперёд на 20 шагов>>, 
<<влево на 90 градусов>>, как в <<черепашке>>. Поэтому (и с учётом того, что 
обучение информатике на этих конструкторах начинается с пятого класса) требуется 
представлять программу возможно более наглядно, и графические языки подходят 
для этой цели гораздо лучше, чем текстовые. 

Первый прототип среды программирования был разработан автором данной диссертации
с использованием системы QReal примерно за неделю, и включал в себя визуальный 
язык из примерно 20 сущностей, редактор к нему и интерпретатор, позволяющий 
исполнить программу на компьютере, посылая команды роботу по интерфейсу 
\ac{Bluetooth}. 

Среда QReal:Robots демонстрировалась на Открытых состязаниях Санкт-Петербурга по робототехнике 
в 2012 году и на робототехническом фестивале <<Робофест 2012>> в Москве. На данный 
момент эта среда переименована в TRIK Studio и используется как основное средство 
программирования кибернетического конструктора ТРИК~\cite{trik}, 
используется в нескольких робототехнических кружках в России и на мастер-классах по 
робототехнике, проводимых компанией <<Кибернетические технологии>>.

\textbf{Степень достоверности и апробация результатов} раскрывается следующим.
\begin{itemize}
	\item Некоторые результаты данной работы были доложены на второй 
		научно-технической конференции молодых специалистов <<Старт в будущее>> 
		(Санкт-Петербург, 2011) \cite{kuzenkova2011metamodeling}. Доклад был 
		отмечен наградой.
	\item Результаты работы были представлены на международной конференции 
		<<8th International Conference on Evaluation of Novel Approaches to Software Engineering>> 
		(ENASE-2013)~\citescopus{kuzenkova2013qreal}.
	\item Результаты, связанные с применением разработанной технологии при 
		создании среды QReal:Robots были доложены на VII Международной 
		научно-практической конференции <<Современные информационные технологии 
		и ИТ-образование>> (Москва, 2012) \cite{litvinov2012robots} и на конференции 
		<<Central \& Eastern European Software Engineering Conference in Russia --- 2013>> 
		(CEE-SECR'13)~\cite{terekhov2013secr}.
	\item Результаты, связанные с применением разработанной технологии для 
		разработки предметно-ориентированного языка для платформы Ubiq были доложены 
		на международной конференции <<10th Conference of Open Innovations 
		Association FRUCT>>~\cite{bryksin2011ubiq}.
	\item Результаты, связанные с использованием предлагаемой технологии неоднократно 
		представлялись сообществу в виде научных публикаций~\cite{kuzenkova2011qreal, litvinov2013robots,
		terekhov2013qreal, osechkina2010gestures, terekhov2009architecture}
		и докладов на конференциях соавторами работ~\cite{terekhov2013robots, kuzenkova2013refactoring,
		osechkina2012multistroke, bryksin2011qreal, kuzenkova2011metamodeling, bryksin2011robots}.
	\item Проект поддержан грантом Санкт-Петербургского государственного университета 6.39.1054.2012.
\end{itemize}

\textbf{Публикации}. Результаты диссертации отражены в пяти научных работах и одиннадцати тезисах докладов, 
основные результаты изложены в журналах, входящих в перечень ведущих рецензируемых научных 
журналов и изданий, в которых должны быть опубликованы основные научные результаты диссертаций 
на соискание ученых степеней доктора и кандидата наук, утвержденный решением Президиума 
Высшей аттестационной комиссии Минобрнауки России \citevak{litvinov2013robots, kuzenkova2011qreal, terekhov2013qreal},
а также \cite{terekhov2009architecture, osechkina2010gestures} --- в журнале, входящем в РИНЦ. 
Работы в сборниках из перечня ВАК \citevak{kuzenkova2011qreal} и \citevak{terekhov2013qreal}
написаны в соавторстве. В работе \citevak{kuzenkova2011qreal} автору данной диссертации 
принадлежит проектирование и разработка средств метамоделирования, Т.А. Брыксину --- архитектура и реализация основных
компонент платформы, А.С. Кузенковой --- реализация некоторых частей метаредактора, А.О. Дерипаска
--- реализация редактора форм фигур системы QReal, А.В. Подкопаеву --- реализация средств задания правил генерации кода,
К.С. Тарану --- реализация средств эволюции визуальных языков. В работе \citevak{terekhov2013qreal}
автору данной диссертации принадлежит идея и реализация средств метамоделирования, А.Н. Терехову 
принадлежит постановка задачи, Т.А. Брыксину --- разработка архитектуры и реализация основных модулей платформы QReal.

\textbf{Личный вклад автора.} Результаты, представленные в диссертационной работе, получены 
соискателем либо самостоятельно, либо при его непосредственном участии.

Проект QReal в силу своей трудоёмкости разрабатывается большой группой студентов, аспирантов
и преподавателей кафедры системного программирования СПбГУ, соискатель претендует лишь на
результаты, явно перечисленные в списке положений, выносимых на защиту. Особо следует отметить,
что соискатель заявляет как свой результат среду QReal:Robots, её дальнейшее развитие 
TRIK Studio приводится здесь лишь как апробация и внедрение предлагаемых результатов.

Хочется отметить вклад в проект QReal студентов, работавших над проектом QReal под руководством автора 
диссертации: Абрамова Ивана Александровича, Дерипаска Анны Олеговны, Гудошниковой Анны Андреевны, 
Жуковой Беллы Юрьевны, Заболотных Елены Петровны, Занько Софьи Владимировны, Иванова Всеволода Юрьевича, 
Кузенковой Анастасии Сергеевны, Кузнецовой Марьи Юрьевны, Курбанова Рауфа Эльшад оглы, 
Назаренко Владимира Владимировича, Нефёдова Ефима Андреевича, Никольского Кирилла Андреевича, 
Осечкиной Марии Сергеевны, Птахиной Алины Ивановны, Пышновой Александры Витальевны, 
Савина Никиты Сергеевича, Соковиковой Натальи Алексеевны, Такун Евгении Игоревны, 
Тихоновой Марии Валерьевны, всех студентов, работавших под руководством Брыксина Тимофея Александровича, 
а также вклад Дмитрия Мордвинова и Ирины Брюхановой.

\textbf{Положения, выносимые на защиту,} таковы.
\begin{enumerate}
	\item Разработана методика для создания предметно-ориентированных языков с помощью 
		графического языка метамоделирования и сопутствующих визуальных языков.
	\item Предложен новый способ метамоделирования: <<метамоделирование на лету>>, позволяющий
		создавать визуальный язык в процессе его использования.
	\item Предложенные методики реализованы в виде технологии на базе системы QReal.
	\item Проведена апробация разработанных методик и технологии при создании редактора, 
		генератора, средств проверки ограничений среды QReal:Robots и других предметно-ориентированных 
		решений.
\end{enumerate}

Ниже приведён краткий план последующих глав диссертации.

В \textbf{Главе 1} приводятся основные понятия, используемые в 
предметно-ориентированном визуальном моделировании, обсуждается структура 
визуального языка, уровни абстракции, вводятся некоторые свойства визуальных 
языков, важные для дальнейшего изложения.

\textbf{Глава 2} содержит обзор существующих подходов к созданию \ac{DSM}-решений: 
обсуждаются возможности, достоинства и недостатки существующих \ac{DSM}-платформ, 
включая зрелые системы и академические разработки, анализируются существующие 
методологии создания, внедрения и сопровождения визуальных языков и \ac{DSM}-решений, 
делаются выводы, касающиеся текущего состояния исследований в этой области.

\textbf{Глава 3} содержит описание предлагаемого подхода к разработке 
\ac{DSM}-решений: приводятся этапы жизненного цикла \ac{DSM}-решения, обсуждается 
возможная степень автоматизации каждого этапа, формулируются требования на 
средства автоматизации, приводится описание предлагаемой технологии, включающей 
технику метамоделирования <<на лету>>.

В \textbf{Главе 4} анализируются результаты реализации инструментальных средств 
поддержки предлагаемой технологии в проекте QReal. Описываются возможности 
системы QReal, связанные с поддержкой техник метамоделирования, принятые 
архитектурные решения, приводятся соображения по дальнейшему развитию 
инструментальных средств.

\textbf{Приложение A} содержит примеры применения результатов, описанных в данной 
диссертации, для разработки \ac{DSM}-решений. Описывается среда QReal:Robots, то, 
какие преимущества были получены от использования \ac{DSM}-платформы QReal при её 
разработке, то, чем QReal помочь не смог, и почему. Также приводится 
описание среды разработки сервисов для мобильных телефонов QReal:Ubiq и среды
разработки аппаратуры QReal:HaSCoL, описываются их визуальные языки, 
достоинства и недостатки использованных при их создании подходов.

\textbf{Приложение B} содержит описание визуального метаязыка системы QReal.
